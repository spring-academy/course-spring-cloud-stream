+++
title="Submit On-Demand Transactions"
+++

1. Run the app.

   Let's run our application. We will use a 5-second delay between automatically generated transactions to make it easier for us to see our on-demand transactions in the Kafka logs:

   ```shell
   [~/exercises] $ ./gradlew bootRun --args="--spring.integration.poller.fixed-delay=5000"
   ```

   Note that not only are we running our Spring Cloud Stream components, but also our Spring Web components, such as our REST API controller.

1. Use Kafka to verify.

   As we have in previous labs, use an unused Terminal pane to monitor Kafka:

   ```shell
   [~/exercises] $ docker exec -it kafka /opt/kafka/bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic approvalRequest-out-0
   ...
   {"id":-66561165137247368,"cashCard":{"id":6094323678418692169,"owner":"sarah1","amountRequestedForAuth":50.7668781314909}}
   {"id":-5634650775918976902,"cashCard":{"id":3090043269501770643,"owner":"sarah1","amountRequestedForAuth":63.79583001467617}}
   ...
   ```

   You'll see activity every 5 seconds, as generated by the `CashCardTransactionStream` configuration.

1. `POST` transactions.

   Let us now test our `StreamBridge` based on-demand publisher.

   Then from an unused Terminal pane, use `curl` to `POST` a few transactions. Feel free to `POST` a few times, an even change the submitted data if you would like:

   ```shell
   [~/exercises] $ curl -d '{
     "id" : 100,
     "cashCard" : {
       "id" : 209,
       "owner" : "kumar2",
       "amountRequestedForAuth" : 200.0
     }
   }' -H "Content-Type: application/json" -X POST http://localhost:8080/publish/txn
   ```

   You'll see the `POST`ed transactions immediately pushed into Kafka, along with our auto-generated transactions.

   ```shell
   ...
   {"id":-5884276558030210833,"cashCard":{"id":-2255250790195745652,"owner":"sarah1","amountRequestedForAuth":90.69339964569193}}
   {"id":5266952642528070044,"cashCard":{"id":-5780440342191504864,"owner":"sarah1","amountRequestedForAuth":21.80623845666293}}
   {"id":100,"cashCard":{"id":209,"owner":"kumar2","amountRequestedForAuth":200.0}}
   {"id":100,"cashCard":{"id":209,"owner":"kumar2","amountRequestedForAuth":200.0}}
   {"id":100,"cashCard":{"id":209,"owner":"kumar2","amountRequestedForAuth":200.0}}
   {"id":-4042360335249930640,"cashCard":{"id":-8391359726931016778,"owner":"sarah1","amountRequestedForAuth":85.5669171882778}}
   ```

   Pretty amazing stuff!
